<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Multiflex: config-chain</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Multiflex
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">config-chain </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >A module for loading custom configurations</p>
<h1><a class="anchor" id="autotoc_md631"></a>
NOTE: Feature Freeze</h1>
<p ><a href="http://github.com/badges/stability-badges"><img src="http://badges.github.io/stability-badges/dist/locked.svg" alt="locked" style="pointer-events: none;" class="inline"/></a></p>
<p >This module is frozen.</p>
<p >In general, we recommend using <a href="https://github.com/dominictarr/rc">rc</a> instead, but as <a href="https://github.com/npmjs/npm">npm</a> depends on this, it cannot be changed.</p>
<h1><a class="anchor" id="autotoc_md632"></a>
Install</h1>
<div class="fragment"><div class="line">yarn add config-chain</div>
<div class="line"> </div>
<div class="line"># npm users</div>
<div class="line">npm install --save config-chain</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md633"></a>
Usage</h1>
<div class="fragment"><div class="line">const cc = require(&#39;config-chain&#39;);</div>
<div class="line"> </div>
<div class="line">console.log(cc.env(&#39;TERM_&#39;, process.env));</div>
<div class="line">/*</div>
<div class="line">{ SESSION_ID: &#39;w1:5F38&#39;,</div>
<div class="line">  PROGRAM_VERSION: &#39;3.1.2&#39;,</div>
<div class="line">  PROGRAM: &#39;iTerm.app&#39; }</div>
<div class="line">*/</div>
</div><!-- fragment --><p >The <code>.env</code> function gets all the keys on the provided object which are prefixed by the specified prefix, removes the prefix, and puts the values on a new object.</p>
<p ><br  />
</p>
<h1><a class="anchor" id="autotoc_md634"></a>
Full Usage</h1>
<div class="fragment"><div class="line">// npm install config-chain</div>
<div class="line"> </div>
<div class="line">var cc = require(&#39;config-chain&#39;)</div>
<div class="line">  , opts = require(&#39;optimist&#39;).argv //ALWAYS USE OPTIMIST FOR COMMAND LINE OPTIONS.</div>
<div class="line">  , env = opts.env || process.env.YOUR_APP_ENV || &#39;dev&#39; //SET YOUR ENV LIKE THIS.</div>
<div class="line"> </div>
<div class="line">// EACH ARG TO CONFIGURATOR IS LOADED INTO CONFIGURATION CHAIN</div>
<div class="line">// EARLIER ITEMS OVERIDE LATER ITEMS</div>
<div class="line">// PUTS COMMAND LINE OPTS FIRST, AND DEFAULTS LAST!</div>
<div class="line"> </div>
<div class="line">//strings are interpereted as filenames.</div>
<div class="line">//will be loaded synchronously</div>
<div class="line"> </div>
<div class="line">var conf =</div>
<div class="line">cc(</div>
<div class="line">  //OVERRIDE SETTINGS WITH COMMAND LINE OPTS</div>
<div class="line">  opts,</div>
<div class="line"> </div>
<div class="line">  //ENV VARS IF PREFIXED WITH &#39;myApp_&#39;</div>
<div class="line"> </div>
<div class="line">  cc.env(&#39;myApp_&#39;), //myApp_foo = &#39;like this&#39;</div>
<div class="line"> </div>
<div class="line">  //FILE NAMED BY ENV</div>
<div class="line">  path.join(__dirname,  &#39;config.&#39; + env + &#39;.json&#39;),</div>
<div class="line"> </div>
<div class="line">  //IF `env` is PRODUCTION</div>
<div class="line">  env === &#39;prod&#39;</div>
<div class="line">    ? path.join(__dirname, &#39;special.json&#39;) //load a special file</div>
<div class="line">    : null //NULL IS IGNORED!</div>
<div class="line"> </div>
<div class="line">  //SUBDIR FOR ENV CONFIG</div>
<div class="line">  path.join(__dirname,  &#39;config&#39;, env, &#39;config.json&#39;),</div>
<div class="line"> </div>
<div class="line">  //SEARCH PARENT DIRECTORIES FROM CURRENT DIR FOR FILE</div>
<div class="line">  cc.find(&#39;config.json&#39;),</div>
<div class="line"> </div>
<div class="line">  //PUT DEFAULTS LAST</div>
<div class="line">  {</div>
<div class="line">    host: &#39;localhost&#39;</div>
<div class="line">    port: 8000</div>
<div class="line">  })</div>
<div class="line"> </div>
<div class="line">var host = conf.get(&#39;host&#39;)</div>
<div class="line"> </div>
<div class="line">// or</div>
<div class="line"> </div>
<div class="line">var host = conf.store.host</div>
</div><!-- fragment --><p >Finally, flexible configurations! ðŸ‘Œ</p>
<h1><a class="anchor" id="autotoc_md635"></a>
Custom Configuations</h1>
<div class="fragment"><div class="line">var cc = require(&#39;config-chain&#39;)</div>
<div class="line"> </div>
<div class="line">// all the stuff you did before</div>
<div class="line">var config = cc({</div>
<div class="line">      some: &#39;object&#39;</div>
<div class="line">    },</div>
<div class="line">    cc.find(&#39;config.json&#39;),</div>
<div class="line">    cc.env(&#39;myApp_&#39;)</div>
<div class="line">  )</div>
<div class="line">  // CONFIGS AS A SERVICE, aka &quot;CaaS&quot;, aka EVERY DEVOPS DREAM OMG!</div>
<div class="line">  .addUrl(&#39;http://configurator:1234/my-configs&#39;)</div>
<div class="line">  // ASYNC FTW!</div>
<div class="line">  .addFile(&#39;/path/to/file.json&#39;)</div>
<div class="line"> </div>
<div class="line">  // OBJECTS ARE OK TOO, they&#39;re SYNC but they still ORDER RIGHT</div>
<div class="line">  // BECAUSE PROMISES ARE USED BUT NO, NOT *THOSE* PROMISES, JUST</div>
<div class="line">  // ACTUAL PROMISES LIKE YOU MAKE TO YOUR MOM, KEPT OUT OF LOVE</div>
<div class="line">  .add({ another: &#39;object&#39; })</div>
<div class="line"> </div>
<div class="line">  // DIE A THOUSAND DEATHS IF THIS EVER HAPPENS!!</div>
<div class="line">  .on(&#39;error&#39;, function (er) {</div>
<div class="line">    // IF ONLY THERE WAS SOMETHIGN HARDER THAN THROW</div>
<div class="line">    // MY SORROW COULD BE ADEQUATELY EXPRESSED.  /o\</div>
<div class="line">    throw er</div>
<div class="line">  })</div>
<div class="line"> </div>
<div class="line">  // THROW A PARTY IN YOUR FACE WHEN ITS ALL LOADED!!</div>
<div class="line">  .on(&#39;load&#39;, function (config) {</div>
<div class="line">    console.awesome(&#39;HOLY SHIT!&#39;)</div>
<div class="line">  })</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md636"></a>
API Docs</h1>
<h2><a class="anchor" id="autotoc_md637"></a>
cc(...args)</h2>
<p >MAKE A CHAIN AND ADD ALL THE ARGS.</p>
<p >If the arg is a STRING, then it shall be a JSON FILENAME.</p>
<p >RETURN THE CHAIN!</p>
<h2><a class="anchor" id="autotoc_md638"></a>
cc.json(...args)</h2>
<p >Join the args into a JSON filename!</p>
<p >SYNC I/O!</p>
<h2><a class="anchor" id="autotoc_md639"></a>
cc.find(relativePath)</h2>
<p >SEEK the RELATIVE PATH by climbing the TREE OF DIRECTORIES.</p>
<p >RETURN THE FOUND PATH!</p>
<p >SYNC I/O!</p>
<h2><a class="anchor" id="autotoc_md640"></a>
cc.parse(content, file, type)</h2>
<p >Parse the content string, and guess the type from either the specified type or the filename.</p>
<p >RETURN THE RESULTING OBJECT!</p>
<p >NO I/O!</p>
<h2><a class="anchor" id="autotoc_md641"></a>
cc.env(prefix, env=process.env)</h2>
<p >Get all the keys on the provided object which are prefixed by the specified prefix, removes the prefix, and puts the values on a new object.</p>
<p >RETURN THE RESULTING OBJECT!</p>
<p >NO I/O!</p>
<h2><a class="anchor" id="autotoc_md642"></a>
cc.ConfigChain()</h2>
<p >The ConfigChain class for CRAY CRAY JQUERY STYLE METHOD CHAINING!</p>
<p >One of these is returned by the main exported function, as well.</p>
<p >It inherits (prototypically) from <a href="https://github.com/isaacs/proto-list/">ProtoList</a>, and also inherits (parasitically) from <a href="http://nodejs.org/api/events.html#events_class_events_eventemitter">EventEmitter</a></p>
<p >It has all the methods from both, and except where noted, they are unchanged.</p>
<h3><a class="anchor" id="autotoc_md643"></a>
LET IT BE KNOWN THAT chain IS AN INSTANCE OF ConfigChain.</h3>
<h2><a class="anchor" id="autotoc_md644"></a>
chain.sources</h2>
<p >A list of all the places where it got stuff. The keys are the names passed to addFile or addUrl etc, and the value is an object with some info about the data source.</p>
<h2><a class="anchor" id="autotoc_md645"></a>
chain.addFile(filename, type, [name=filename])</h2>
<p >Filename is the name of the file. Name is an arbitrary string to be used later if you desire. Type is either 'ini' or 'json', and will try to guess intelligently if omitted.</p>
<p >Loaded files can be saved later.</p>
<h2><a class="anchor" id="autotoc_md646"></a>
chain.addUrl(url, type, [name=url])</h2>
<p >Same as the filename thing, but with a url.</p>
<p >Can't be saved later.</p>
<h2><a class="anchor" id="autotoc_md647"></a>
chain.addEnv(prefix, env, [name='env'])</h2>
<p >Add all the keys from the env object that start with the prefix.</p>
<h2><a class="anchor" id="autotoc_md648"></a>
chain.addString(data, file, type, [name])</h2>
<p >Parse the string and add it to the set. (Mainly used internally.)</p>
<h2><a class="anchor" id="autotoc_md649"></a>
chain.add(object, [name])</h2>
<p >Add the object to the set.</p>
<h2><a class="anchor" id="autotoc_md650"></a>
chain.root {Object}</h2>
<p >The root from which all the other config objects in the set descend prototypically.</p>
<p >Put your defaults here.</p>
<h2><a class="anchor" id="autotoc_md651"></a>
chain.set(key, value, name)</h2>
<p >Set the key to the value on the named config object. If name is unset, then set it on the first config object in the set. (That is, the one with the highest priority, which was added first.)</p>
<h2><a class="anchor" id="autotoc_md652"></a>
chain.get(key, [name])</h2>
<p >Get the key from the named config object explicitly, or from the resolved configs if not specified.</p>
<h2><a class="anchor" id="autotoc_md653"></a>
chain.save(name, type)</h2>
<p >Write the named config object back to its origin.</p>
<p >Currently only supported for env and file config types.</p>
<p >For files, encode the data according to the type.</p>
<h2><a class="anchor" id="autotoc_md654"></a>
chain.on('save', function () {})</h2>
<p >When one or more files are saved, emits <code>save</code> event when they're all saved.</p>
<h2><a class="anchor" id="autotoc_md655"></a>
chain.on('load', function (chain) {})</h2>
<p >When the config chain has loaded all the specified files and urls and such, the 'load' event fires. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
